/*
 * angular-sticky-plugin
 * https://github.com/harm-less/angular-sticky

 * Version: 0.4.1 - 2017-06-12
 * License: MIT
 */
"use strict";angular.module("hl.sticky",[]).factory("mediaQuery",function(){return{matches:function(t){return t&&(matchMedia("("+t+")").matches||matchMedia(t).matches)}}}).factory("hlStickyStack",["$document","DefaultStickyStackName",function(t,n){function e(t){var e=(t=t||{}).name||n;if(r[e])return r[e];var i=1039,a=[],c={};return c.options=t,c.stackName=e,c.add=function(t,n){return angular.isString(t)&&""!==t||(t=c.length()),n.id=t,n.zIndex=i,a.push(n),i-=1,n},c.get=function(t){for(var n=0;n<a.length;n++)if(t==a[n].id)return a[n];return!1},c.index=function(t){for(var n=0;n<a.length;n++)if(t==a[n].id)return n;return-1},c.range=function(t,n){return a.slice(t,n)},c.all=function(){return a},c.keys=function(){for(var t=[],n=0;n<a.length;n++)t.push(a[n].id);return t},c.top=function(){return a[a.length-1]},c.remove=function(t){for(var n=0;n<a.length;n++)if(t==a[n].id)return i+=1,a.splice(n,1)[0];return!1},c.removeTop=function(){return i+=1,a.splice(a.length-1,1)[0]},c.length=function(){return a.length},c.height=function(t){var n={top:0,bottom:0};return angular.forEach(a,function(e){n[e.anchor()]+=e.computedHeight(t)}),n[t]},c.heightAt=function(t,n){for(var e,o,r=n-1,i={top:0,bottom:0},c=0;c<a.length;c++)if((e=a[c]).sticksAtPosition(t,r)){var u=e.anchor();o=e.computedHeight(t,r-i[u]),i[u]+=o}return i[t]},c.heightCurrent=function(t){return c.heightAt(t,window.pageYOffset||o.scrollTop)},r[e]=c,c}var o=t[0].documentElement,r={};return e}]).factory("hlStickyElement",["$document","$log","hlStickyStack","throttle","mediaQuery",function(t,n,e,o,r){return function(o,i){function a(){return P?D:D=k(I)-O-b()}function c(){return P?z:z=w(I)+L+E()}function u(){return!angular.isDefined(i.enable)||i.enable}function l(){return u()&&P||i.alwaysSticky}function f(t,e){if(!h())return!1;switch(t){case"top":return s(e);case"bottom":return d(e);default:n.error('Unknown anchor "'+t+'"')}return!1}function s(t){return(t=void 0!==t?t:window.pageYOffset||T.scrollTop)-(M.clientTop||0)>=a()}function d(t){return(t=void 0!==t?t:window.pageYOffset||T.scrollTop)+window.innerHeight<=c()}function h(){return!1===Q||r.matches(Q)}function m(){var t=f(R);angular.isDefined(i.enable)&&!i.enable&&(t=!1),angular.isDefined(i.alwaysSticky)&&i.alwaysSticky&&(t=!0),t&&!P?(g(),q({event:"stick"})):!t&&P&&(y(),q({event:"unstick"})),P&&("top"===R?o.css("top",O+S(R)-C()+"px"):"bottom"===R&&o.css("bottom",L+S(R)-$()+"px"),o.css("width",p()+"px"))}function g(){P=!0,o.addClass(A),N&&((H=H||angular.element("<div>")).css("height",v()+"px"),o.after(H));var t=I.getBoundingClientRect(),n={width:p()+"px",position:"fixed",left:t.left+"px","z-index":j?j.get(B).zIndex-(F.zIndex||0):null};n["margin-"+R]=0,o.css(n)}function y(){P=!1,o.removeClass(A),o.attr("style",U.style),H&&H.remove()}function p(){return I.offsetWidth}function v(){return I.offsetHeight}function k(t){var n=0;if(t&&t.offsetParent)do{n+=t.offsetTop,t=t.offsetParent}while(t);return n}function w(t){return k(t)+t.clientHeight}function S(t){var n=0;if("top"===t&&F.top>0&&(n+=F.top),"bottom"===t&&F.bottom>0&&(n+=F.bottom),j){var e=j.index(B);"top"===t&&e>0&&j.range(0,e).forEach(function(e){e.isSticky()&&(n+=e.computedHeight(t))}),"bottom"===t&&e!==j.length()-1&&j.range(e+1,j.length()).forEach(function(e){e.isSticky()&&(n+=e.computedHeight(t))})}return n}function b(){return S("top")}function E(){return S("bottom")}function x(t,n){return"top"===t?Math.max(0,v()-C(n)+O):"bottom"===t?Math.max(0,v()-$(n)+L):0}function $(t){if(null===Y&&(Y=void 0!==i.container&&(angular.isString(i.container)?angular.element(M.querySelector("#"+i.container))[0]:i.container)),Y){var n=!(null===t||void 0===t),e=Y.getBoundingClientRect(),o=n?k(Y)+e.height-t:e.top-window.innerHeight+v();return Math.max(0,o-(O+S(R)))}return 0}function C(t){if(null===Y&&(Y=void 0!==i.container&&(angular.isString(i.container)?angular.element(M.querySelector("#"+i.container))[0]:i.container)),Y){var n=!(null===t||void 0===t),e=Y.getBoundingClientRect(),o=n?k(Y)+e.height-t:e.bottom;return Math.max(0,O+S(R)+v()-o)}return 0}i=i||{};var D,z,H,P=!1,T=angular.element(t[0].body),I=o[0],M=t[0].documentElement,B=i.id||null,Q=!!angular.isDefined(i.mediaQuery)&&i.mediaQuery,A=angular.isString(i.stickyClass)&&""!==i.stickyClass?i.stickyClass:"is-sticky",N=!angular.isDefined(i.usePlaceholder)||i.usePlaceholder,O=i.offsetTop?parseInt(i.offsetTop):0,L=i.offsetBottom?parseInt(i.offsetBottom):0,R="string"==typeof i.anchor?i.anchor.toLowerCase().trim():"top",Y=null,j=!1===i.stack?null:i.stack||e(),q=angular.isFunction(i.event)?i.event:angular.noop,F={top:0,bottom:0},U={style:o.attr("style")||""},W={};if(j){var G=j.add(B,W);B=G.id}return W.draw=function(t){var n=(t=t||{}).offset;n&&(F.top=n.top||0,F.bottom=n.bottom||0,F.zIndex=n.zIndex),!0===t.force&&y(),m()},W.anchor=function(){return R},W.isSticky=l,W.isEnabled=u,W.computedHeight=x,W.sticksAtPosition=f,W.destroy=function(){y(),j&&j.remove(B)},W}}]).constant("DefaultStickyStackName","default-stack").provider("hlStickyElementCollection",function(){var t=0,n={collections:{},defaults:{checkDelay:250},elementsDefaults:{},$get:["$rootScope","$window","$document","$log","DefaultStickyStackName","hlStickyElement","hlStickyStack","throttle",function(e,o,r,i,a,c,u,l){function f(){++t>1||(v=l(h,n.defaults.checkDelay,{leading:!1}),k.on("resize",v),k.on("scroll",d),y=e.$on("$viewContentLoaded",v),p=e.$on("$includeContentLoaded",v),v())}function s(){--t>0||(k.off("resize",v),k.off("scroll",d),y(),p())}function d(){m()}function h(){m({force:!0})}function m(t){angular.forEach(n.collections,function(n){n.draw(t)})}function g(t){t&&angular.isObject(t)||(i.warn("Must supply an options object"),t={});var e=(t=angular.extend({},n.elementsDefaults,t)).name||a;if(n.collections[e])return n.collections[e];var o=u({name:e}),r=[],l={};return l.addElement=function(t,n){(n=n||{}).stack=o;var e=c(t,n);return r.push({stickyElement:e,element:t}),e},l.removeElement=function(t){for(var n,e=r.length;e--;)if(angular.isString(t)&&"#"+r[e].element.id===t||r[e].element===t){n=e;break}var o=r.splice(n,1)[0];return o&&o.stickyElement.destroy(),o},l.draw=function(n){var e={};if(t.parent){var o=u({name:t.parent});e.offset={top:o.heightCurrent("top"),zIndex:o.length()}}angular.extend(e,n||{}),angular.forEach(r,function(t){t.stickyElement.draw(e)})},l.destroy=function(){angular.forEach(angular.copy(r),function(t){l.removeElement(t)}),delete n.collections[e],s()},l.trackedElements=function(){return r},n.collections[e]=l,f(),l}var y,p,v,k=angular.element(o);return g}]};return n}).directive("hlSticky",["$log","$window","$document","hlStickyElementCollection",function(t,n,e,o){return{restrict:"A",scope:{container:"@",anchor:"@",stickyClass:"@",mediaQuery:"@",collection:"@",collectionParent:"@",event:"&",enable:"=",alwaysSticky:"="},link:function(t,n,e){n.addClass("hl-sticky");var r=o({name:t.collection,parent:t.collectionParent}),i={id:e.hlSticky,event:function(n){t.event({event:n})}};angular.forEach(["anchor","container","stickyClass","mediaQuery","enable","alwaysSticky"],function(n){angular.isDefined(t[n])&&(i[n]=t[n])}),angular.forEach(["usePlaceholder","offsetTop","offsetBottom"],function(n){angular.isDefined(e[n])&&(i[n]=t.$parent.$eval(e[n]))}),r.addElement(n,i),t.$watch("enable",function(n,e){n!==e&&(i.enable=t.enable,r.draw({force:!0}))}),t.$watch("alwaysSticky",function(n,e){n!==e&&(i.alwaysSticky=t.alwaysSticky,r.draw({force:!0}))}),t.$on("$destroy",function(){r.removeElement(n),r.trackedElements().length||r.destroy()})}}}]).factory("throttle",["$timeout",function(t){return function(n,e,o){var r=null;return o=o||{},function(){var i=this,a=arguments;r||(!1!==o.leading&&n.apply(i,a),r=t(function(){r=null,!1!==o.trailing&&n.apply(i,a)},e,!1))}}}]);